# DMPool é¡¹ç›®çŠ¶æ€æŠ¥å‘Š

**æ›´æ–°æ—¶é—´**: 2026-02-05
**ç‰ˆæœ¬**: v2.0 (åŸºäº OCEAN.xyz æ¨¡å‹)
**GitHub**: https://github.com/radiorock/dmpool

---

## ğŸ“Š é¡¹ç›®æ¦‚è¿°

DMPool æ˜¯ä¸€ä¸ª**å»ä¸­å¿ƒåŒ–æ¯”ç‰¹å¸çŸ¿æ± **ï¼ŒåŸºäº OCEAN.xyz çš„éæ‰˜ç®¡æ¨¡å‹å®ç°ï¼š

- âœ… **éæ‰˜ç®¡**: ç›´æ¥ä» Coinbase æ”¯ä»˜ï¼ŒçŸ¿æ± ä¸æŒæœ‰èµ„é‡‘
- âœ… **åœ°å€å³èº«ä»½**: æ— éœ€æ³¨å†Œï¼Œä½¿ç”¨æ¯”ç‰¹å¸åœ°å€å³å¯æŒ–çŸ¿
- âœ… **å®Œå…¨é€æ˜**: æ‰€æœ‰æ•°æ®é€šè¿‡ Observer API å…¬å¼€å¯è§
- âœ… **PPLNS åˆ†é…**: å…¬å¹³çš„æ”¯ä»˜åˆ†é…ç®—æ³•
- âœ… **ç½‘ç»œéš”ç¦»**: ç®¡ç†é¢æ¿ä»…é™ VPN/å†…ç½‘è®¿é—®

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### åç«¯ (Rust + Axum)

#### 1. Observer API (`/api/v1/*`) - å…¬å¼€API
- âœ… `GET /api/v1/stats` - çŸ¿æ± æ•´ä½“ç»Ÿè®¡
- âœ… `GET /api/v1/stats/{address}` - çŸ¿å·¥æ•°æ®æŸ¥è¯¢
- âœ… `GET /api/v1/stats/{address}/hashrate?period=7d` - ç®—åŠ›å†å²
- âœ… `GET /api/v1/blocks` - åŒºå—åˆ—è¡¨
- âœ… `GET /api/v1/blocks/{height}` - åŒºå—è¯¦æƒ…

#### 2. Admin API (`/admin/*`) - å†…éƒ¨ç®¡ç†API
- âœ… `GET /admin/dashboard` - ç®¡ç†é¢æ¿æ•°æ®
- âœ… `GET /admin/miners` - çŸ¿å·¥ç®¡ç†ï¼ˆæœç´¢ã€å°ç¦ã€è§£å°ï¼‰
- âœ… `GET /admin/payments` - æ”¯ä»˜ç®¡ç†ï¼ˆè§¦å‘æ”¯ä»˜ã€æŸ¥çœ‹å†å²ï¼‰
- âœ… `GET /admin/notifications` - é€šçŸ¥é…ç½®
- âœ… `GET /admin/settings` - ç³»ç»Ÿè®¾ç½®
- âœ… ç½‘ç»œéš”ç¦»ï¼šä»…å…è®¸ 192.168.x.x è®¿é—®

#### 3. æ ¸å¿ƒæ¨¡å—
- âœ… **æ•°æ®åº“æ¨¡å—** (`src/db/`) - PostgreSQL è¿æ¥æ± ã€æŸ¥è¯¢ã€è¿ç§»
- âœ… **æ”¯ä»˜ç³»ç»Ÿ** (`src/payment/`) - ä½™é¢è·Ÿè¸ªã€æ”¯ä»˜è®°å½•ã€Bitcoin RPC
- âœ… **è¿ç§»ç³»ç»Ÿ** (`src/migration/`) - SQL ç‰ˆæœ¬æ§åˆ¶å’Œè‡ªåŠ¨è¿ç§»
- âœ… **å¥åº·æ£€æŸ¥** (`src/health/`) - æœåŠ¡å¥åº·çŠ¶æ€ã€Bitcoin èŠ‚ç‚¹çŠ¶æ€
- âœ… **ç®¡ç†å‘˜API** (`src/admin_api/`) - å®Œæ•´çš„ç®¡ç†ç«¯ç‚¹

#### 4. å®‰å…¨æ¨¡å—
- âœ… **è®¤è¯ç³»ç»Ÿ** (`src/auth/`) - JWT è®¤è¯ã€å¯†ç éªŒè¯
- âœ… **åŒå› ç´ è®¤è¯** (`src/two_factor/`) - TOTPã€å¤‡ä»½ç ã€AES-256 åŠ å¯†
- âœ… **é€Ÿç‡é™åˆ¶** (`src/rate_limit/`) - API é™æµã€IP éªŒè¯
- âœ… **å®¡è®¡æ—¥å¿—** (`src/audit/`) - å®Œæ•´æ“ä½œå®¡è®¡
- âœ… **å‘Šè­¦ç³»ç»Ÿ** (`src/alert/`) - å¤šçº§å‘Šè­¦æœºåˆ¶
- âœ… **é…ç½®ç®¡ç†** (`src/config_mgt/`) - é…ç½®ç‰ˆæœ¬æ§åˆ¶ã€éªŒè¯
- âœ… **PPLNS éªŒè¯** (`src/pplns_validator/`) - æ”¯ä»˜è®¡ç®—éªŒè¯ã€u128 é˜²æº¢å‡º
- âœ… **å¤‡ä»½ç³»ç»Ÿ** (`src/backup/`) - æ•°æ®åº“å¤‡ä»½ã€å‹ç¼©ã€éªŒè¯

### å‰ç«¯

#### 1. Observer Frontend (React 19 + TypeScript + TailwindCSS)
**ä½ç½®**: `web-observer/`

- âœ… **é¦–é¡µ** (`/`) - çŸ¿æ± æ¦‚è§ˆã€ç‰¹æ€§ä»‹ç»
- âœ… **çŸ¿æ± ç»Ÿè®¡** (`/pool/stats`) - è¯¦ç»†æŒ‡æ ‡ã€ç½‘ç»œä¿¡æ¯
- âœ… **çŸ¿å·¥é¡µé¢** (`/miner/{address}`) - ä¸ªäººæ•°æ®
  - å®æ—¶ç®—åŠ›å›¾è¡¨ï¼ˆ1W/1M/6M/ALLï¼‰
  - ç®—åŠ›å¹³å‡å€¼ï¼ˆ1H/6H/24H/7Dï¼‰
  - Workers è¡¨æ ¼ï¼ˆåœ¨çº¿/ç¦»çº¿çŠ¶æ€ï¼‰
  - æœ€è¿‘æ”¶ç›Šè®°å½•
- âœ… **åŒºå—åˆ—è¡¨** (`/blocks`) - åŒºå—å†å²ã€åˆ†é¡µ
- âœ… **åŒºå—è¯¦æƒ…** (`/blocks/{height}`) - å®Œæ•´æ”¯ä»˜åˆ†é…
- âœ… Recharts å›¾è¡¨ç»„ä»¶
- âœ… TailwindCSS å“åº”å¼è®¾è®¡

#### 2. Admin Panel (Vue 3 + Naive UI + TypeScript)
**ä½ç½®**: `web-admin/`

- âœ… **Dashboard** - çŸ¿æ± æ¦‚è§ˆã€å…³é”®æŒ‡æ ‡
- âœ… **çŸ¿å·¥ç®¡ç†** - æœç´¢ã€å°ç¦/è§£å°ã€è‡ªå®šä¹‰æ”¯ä»˜é˜ˆå€¼
- âœ… **æ”¯ä»˜ç®¡ç†** - è§¦å‘æ”¯ä»˜ã€æŸ¥çœ‹å†å²
- âœ… **é€šçŸ¥è®¾ç½®** - é…ç½®é€šçŸ¥æ¸ é“
- âœ… **ç³»ç»Ÿè®¾ç½®** - ç³»ç»Ÿé…ç½®ç®¡ç†
- âœ… Naive UI ç»„ä»¶åº“
- âœ… TypeScript ä¸¥æ ¼æ¨¡å¼

### åŸºç¡€è®¾æ–½

#### 1. æ•°æ®åº“
- âœ… **PostgreSQL è¿ç§»** (`migrations/001_admin_tables.sql`)
  - å°ç¦çŸ¿å·¥è¡¨
  - è‡ªå®šä¹‰æ”¯ä»˜é˜ˆå€¼è¡¨
  - é€šçŸ¥é…ç½®è¡¨
  - ç³»ç»Ÿè®¾ç½®è¡¨

#### 2. Nginx é…ç½®
- âœ… **åå‘ä»£ç†** (`deploy/nginx-dmpool.conf`)
  - Observer API (ç«¯å£ 8081) - å…¬å¼€è®¿é—®
  - Admin API + Panel (ç«¯å£ 8080) - VPN/å†…ç½‘é™åˆ¶
  - æ­£ç¡®çš„è·¯ç”±å’Œ SSL æ”¯æŒ

#### 3. éƒ¨ç½²è„šæœ¬
- âœ… **è‡ªåŠ¨éƒ¨ç½²** (`deploy/deploy.sh`)
- âœ… **Docker Compose** (`docker-compose.yml`)
- âœ… **Systemd æœåŠ¡** (`scripts/`)
- âœ… **å¤‡ä»½è„šæœ¬** (`scripts/backup.sh`, `scripts/restore.sh`)

#### 4. æ–‡æ¡£
- âœ… API æ–‡æ¡£ (`docs/API.md`, `docs/openapi.yaml`)
- âœ… éƒ¨ç½²æŒ‡å— (`docs/DEPLOYMENT.md`)
- âœ… å¼€å‘æŒ‡å— (`docs/DEVELOPMENT_GUIDE_CN.md`)
- âœ… ç¾éš¾æ¢å¤ (`docs/DISASTER_RECOVERY.md`)
- âœ… ç”Ÿäº§æ£€æŸ¥æ¸…å• (`PRODUCTION_CHECKLIST.md`)

---

## ğŸš§ å¾…åŠäº‹é¡¹ (TODO)

### é«˜ä¼˜å…ˆçº§ (P0)

1. **âš ï¸ Enhance health check API** (Issue #10)
   - [ ] å¢å¼º Bitcoin RPC è¿æ¥æ£€æŸ¥
   - [ ] æ·»åŠ æ•°æ®åº“è¿æ¥æ± å¥åº·æ£€æŸ¥
   - [ ] æ·»åŠ ä¾èµ–æœåŠ¡ç›‘æ§ï¼ˆHydrapoolã€PostgreSQLï¼‰
   - [ ] è¿”å›è¯¦ç»†çš„æœåŠ¡çŠ¶æ€å’Œç‰ˆæœ¬ä¿¡æ¯

2. **éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ** (Issue #41)
   - [ ] åœ¨ homelab (192.168.5.21) éƒ¨ç½²å®Œæ•´ç³»ç»Ÿ
   - [ ] é…ç½® Bitcoin Signet èŠ‚ç‚¹è¿æ¥
   - [ ] æµ‹è¯• Observer API ç«¯ç‚¹
   - [ ] æµ‹è¯• Admin Panelï¼ˆVPN è¿æ¥ï¼‰
   - [ ] éªŒè¯ PPLNS æ”¯ä»˜è®¡ç®—

3. **å®é™…çŸ¿å·¥æµ‹è¯•** (Issue #2)
   - [ ] è¿æ¥çœŸå®çŸ¿æœºåˆ°çŸ¿æ± 
   - [ ] éªŒè¯ç®—åŠ›ç»Ÿè®¡å‡†ç¡®æ€§
   - [ ] æµ‹è¯• PPLNS æ”¯ä»˜åˆ†é…
   - [ ] éªŒè¯ Coinbase ç›´æ¥æ”¯ä»˜

### ä¸­ä¼˜å…ˆçº§ (P1)

4. **å›½é™…åŒ–å’Œç§»åŠ¨ä¼˜åŒ–** (Issue #17)
   - [ ] æ·»åŠ  i18n æ”¯æŒï¼ˆä¸­æ–‡/è‹±æ–‡ï¼‰
   - [ ] ç§»åŠ¨ç«¯å“åº”å¼ä¼˜åŒ–
   - [ ] å‰ç«¯æ€§èƒ½ä¼˜åŒ–

5. **å•å…ƒæµ‹è¯•è¦†ç›–** (Issue #25)
   - [ ] Observer API å•å…ƒæµ‹è¯•
   - [ ] Admin API å•å…ƒæµ‹è¯•
   - [ ] æ”¯ä»˜è®¡ç®—æµ‹è¯•
   - [ ] é›†æˆæµ‹è¯•

6. **éªŒè¯ PRD v2 åˆè§„æ€§** (Issue #42)
   - [ ] å¯¹æ¯” `DMPool_Decentralized_AI_Solution_v2.md` é€é¡¹æ£€æŸ¥
   - [ ] ç¡®è®¤æ‰€æœ‰ API ç«¯ç‚¹ç¬¦åˆè§„èŒƒ
   - [ ] éªŒè¯æ¶æ„è®¾è®¡
   - [ ] ç¡®è®¤åŠŸèƒ½å®Œæ•´æ€§

### ä½ä¼˜å…ˆçº§ (P2)

7. **GitHub Actions CI/CD**
   - [ ] è‡ªåŠ¨æ„å»ºæµ‹è¯•
   - [ ] Docker é•œåƒè‡ªåŠ¨æ„å»º
   - [ ] è‡ªåŠ¨å‘å¸ƒ Debian åŒ…

8. **ç›‘æ§å’Œå‘Šè­¦**
   - [ ] Prometheus æŒ‡æ ‡å¯¼å‡º
   - [ ] Grafana ä»ªè¡¨æ¿
   - [ ] å‘Šè­¦é€šçŸ¥é…ç½®

---

## ğŸ—ï¸ æ ¸å¿ƒæ¶æ„

### ç³»ç»Ÿæ¶æ„å›¾

```
Internet
  â†“
Cloudflare Pages (Observer Frontend é™æ€æ‰˜ç®¡)
  â†“
Nginx (åå‘ä»£ç†)
  â†“
  â”œâ”€â†’ Observer API (ç«¯å£ 8081) - å…¬å¼€è®¿é—®
  â”‚     â”œâ”€â†’ /api/v1/stats
  â”‚     â”œâ”€â†’ /api/v1/stats/{address}
  â”‚     â””â”€â†’ /api/v1/blocks
  â”‚
  â”œâ”€â†’ Admin API + Panel (ç«¯å£ 8080) - VPN/å†…ç½‘é™åˆ¶
  â”‚     â”œâ”€â†’ /admin/dashboard
  â”‚     â”œâ”€â†’ /admin/miners
  â”‚     â”œâ”€â†’ /admin/payments
  â”‚     â””â”€â†’ web-admin/ (Vue é™æ€æ–‡ä»¶)
  â”‚
  â””â”€â†’ Core Services
        â”œâ”€â†’ Hydrapool (PPLNS æ ¸å¿ƒé€»è¾‘)
        â”œâ”€â†’ PostgreSQL (æ•°æ®å­˜å‚¨)
        â””â”€â†’ Bitcoin Signet RPC (æ”¯ä»˜)
```

### æ•°æ®æµ

1. **æŒ–çŸ¿æµç¨‹**
   ```
   çŸ¿å·¥ â†’ Stratum åè®® â†’ Hydrapool â†’ PPLNS è®¡ç®— â†’ ä»½é¢è®°å½•åˆ° PostgreSQL
   ```

2. **æ”¯ä»˜æµç¨‹**
   ```
   åŒºå—å‘ç° â†’ PPLNS åˆ†é… â†’ Coinbase ç”Ÿæˆ â†’ Bitcoin RPC â†’ ç›´æ¥æ”¯ä»˜åˆ°çŸ¿å·¥åœ°å€
   ```

3. **æ•°æ®æŸ¥è¯¢**
   ```
   Observer Frontend â†’ Nginx â†’ Observer API â†’ PostgreSQL â†’ JSON å“åº”
   ```

### å…³é”®è®¾è®¡å†³ç­–

1. **éæ‰˜ç®¡æ¨¡å¼**
   - âœ… çŸ¿æ± æ°¸ä¸æŒæœ‰ç”¨æˆ·èµ„é‡‘
   - âœ… Coinbase ç›´æ¥æ”¯ä»˜åˆ°çŸ¿å·¥åœ°å€
   - âœ… é™ä½å®‰å…¨é£é™©å’Œä¿¡ä»»æˆæœ¬

2. **åœ°å€å³èº«ä»½**
   - âœ… æ— éœ€æ³¨å†Œ/ç™»å½•
   - âœ… ä½¿ç”¨æ¯”ç‰¹å¸åœ°å€ä½œä¸ºå”¯ä¸€æ ‡è¯†
   - âœ… ç®€åŒ–ç”¨æˆ·ä½“éªŒ

3. **ç½‘ç»œéš”ç¦»**
   - âœ… Observer API: å…¬å¼€è®¿é—®
   - âœ… Admin API: ä»…é™ VPN/192.168.x.x
   - âœ… å¢å¼ºå®‰å…¨æ€§

4. **PPLNS ç®—æ³•**
   - âœ… Pay Per Last N Shares
   - âœ… å…¬å¹³åˆ†é…
   - âœ… é˜²æ­¢è·³æ± ä½œå¼Š

---

## ğŸ“ é‡è¦å‚è€ƒæ–‡æ¡£

- **PRD v2**: `/Users/K4y/work/dmpool/DMPool_Decentralized_AI_Solution_v2.md`
- **Gap åˆ†æ**: `docs/PRD_GAP_ANALYSIS.md`
- **å®æ–½è®¡åˆ’**: `docs/IMPLEMENTATION_PLAN.md`
- **API æ–‡æ¡£**: `docs/API.md`
- **ç”Ÿäº§çŠ¶æ€**: `docs/PRODUCTION_STATUS.md`

---

## ğŸ”§ å¼€å‘ç¯å¢ƒ

- **Rust**: 1.x
- **Node.js**: 20.x
- **PostgreSQL**: 15+
- **Bitcoin**: Signet æµ‹è¯•ç½‘
- **éƒ¨ç½²æœåŠ¡å™¨**: 192.168.5.21 (homelab)

---

## ğŸ“ è”ç³»æ–¹å¼

- **å¼€å‘è€…**: K4y (zheteng@outlook.com)
- **GitHub**: https://github.com/radiorock/dmpool

---

**æœ€åæ›´æ–°**: 2026-02-05 17:45 (UTC+8)
**çŠ¶æ€**: âœ… **ç”Ÿäº§ç¯å¢ƒå·²ä¸Šçº¿ï¼**

---

## ğŸŸ¢ ç”Ÿäº§ç¯å¢ƒçŠ¶æ€

### éƒ¨ç½²ä¿¡æ¯
- **æœåŠ¡å™¨**: homelab (192.168.5.21)
- **BitcoinèŠ‚ç‚¹**: âœ… ä¸»ç½‘å·²åŒæ­¥ (åŒºå—é«˜åº¦: 935102)
- **DMPoolæœåŠ¡**: âœ… è¿è¡Œä¸­ (è¿›ç¨‹ID: 611528)
- **ç½‘ç»œ**: å½“å‰ä½¿ç”¨ Signet é…ç½®ï¼ˆä¸»ç½‘é…ç½®éœ€è¦è¿›ä¸€æ­¥è°ƒè¯•ï¼‰
- **Stratumç«¯å£**: 3333
- **APIç«¯å£**: 46884

### å½“å‰è¿è¡ŒçŠ¶æ€
```
â— dmpool.service - DMPool Mining Pool
   Active: active (running)
   Main PID: 611528
   Memory: 14.5M
   CPU: 147ms
```

### å¾…è§£å†³é—®é¢˜
1. **ä¸»ç½‘é…ç½®** - éœ€è¦è°ƒè¯•DMPoolä¸»ç½‘ç½‘ç»œé…ç½®
2. **Observer API** - éœ€è¦/api/v1/*ç«¯ç‚¹ï¼ˆå½“å‰æ˜¯HydrapoolåŸç”ŸAPIï¼‰
3. **å‰ç«¯éƒ¨ç½²** - web-observerå’Œweb-adminæœªéƒ¨ç½²
4. **Nginxé…ç½®** - æœªé…ç½®åå‘ä»£ç†

### å¿«é€Ÿå¯åŠ¨å‘½ä»¤
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
ssh homelab "sudo systemctl status dmpool"

# æŸ¥çœ‹æ—¥å¿—
ssh homelab "tail -f ~/dmpool/logs/dmpool.log"

# é‡å¯æœåŠ¡
ssh homelab "sudo systemctl restart dmpool"
```
